#include <stdint.h>

enum kgadget {
    KGADGET_POPULATE,
    KGADGET_PROLOGUE,
    KGADGET_MOV_X15_X2__BR_X3,
    KGADGET_MOV_X10_X0__BR_X2,
    KGADGET_MOV_X12_X0__BR_x2,
    KGADGET_MOV_X16_X15__BR_X12,
    KGADGET_MOV_X7_X16__BR_X10,
    KGADGET_MOV_X10_X0__BR_X12,
    KGADGET_MOV_X13_X2__BR_X12,
    KGADGET_MOV_X4_X13__BR_X15,
    KGADGET_ADD_X0_X0_0X40__RET
};

enum ksymbol {
  KSYMBOL_KERNPROC,
  KSYMBOL_RET_300,
  KSYMBOL_KFREE,
  KSYMBOL_KFREE_EXT,
  KSYMBOL_PANIC,
  KSYMBOL_KALLOC_EXT,
  KSYMBOL_KHEAP_DATA_BUFFERS,
  KSYMBOL_KHEAP_DEFAULT,
  KSYMBOL_KHEAP_KEXT,
  KSYMBOL___ZZnamE4site,
  KSYMBOL_KERN_OS_MALLOC,
  KSYMBOL_IOMallocZero_external,
  KSYMBOL____Znam,
  KSYMBOL__necp_set_socket_attributes_site
};

extern uint32_t off_ipc_port_ip_kobject;
extern uint32_t off_task_itk_space;
extern uint32_t off_ipc_space_is_table;
extern uint32_t off_p_pid;
extern uint32_t off_p_list_le_prev;
extern uint32_t off_p_task;
extern uint32_t off_p_pfd;
extern uint32_t off_fg_data;
extern uint32_t off_fp_fglob;
extern uint32_t off_pb_buffer;
extern uint32_t off_pb_cnt;

uint64_t kgad(enum kgadget sym);
uint64_t ksym(enum ksymbol sym);
void offsets_init(void);
