#include <stdint.h>
#include <mach/mach.h>


kern_return_t kextrw_init(void);
void kextrw_deinit(void);

int kextrw_get_kernel_base(void);

kern_return_t
kextrw_kreadbuf(uint64_t kaddr, void *buf, size_t sz);
kern_return_t
kextrw_kwritebuf(uint64_t kaddr, const void *buf, size_t sz);

uint8_t kextrw_kread8(uint64_t where);
uint16_t kextrw_kread16(uint64_t where);
uint32_t kextrw_kread32(uint64_t where);
uint64_t kextrw_kread64(uint64_t where);
void kextrw_kwrite8(uint64_t where, uint8_t what);
void kextrw_kwrite16(uint64_t where, uint16_t what);
void kextrw_kwrite32(uint64_t where, uint32_t what);
void kextrw_kwrite64(uint64_t where, uint64_t what);

void kextrw_khexdump(uint64_t addr, size_t size);

uint64_t kextrw_kcall(uint64_t fn, uint64_t *args, uint32_t argsCnt);

uint64_t xpaci(uint64_t ptr);

uint64_t kextrw_kreadptr(uint64_t addr);