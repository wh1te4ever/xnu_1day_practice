#include <stdint.h>

#define AVM1_21A559_KVERSION "Darwin Kernel Version 21.1.0: Wed Oct 13 17:33:22 PDT 2021; root:xnu-8019.41.5~1/RELEASE_ARM64_VMAPPLE"
#define VM_KERNEL_LINK_ADDR 0xFFFFFE0007004000ULL

enum kmajor {
  KVERSION_21
};

enum ksymbol {
  KSYMBOL_KERNPROC
};

extern uint32_t off_p_pid;
extern uint32_t off_p_pfd;
extern uint32_t off_p_list_le_prev;
extern uint32_t off_p_task;
extern uint32_t off_task_itk_space;
extern uint32_t off_ipc_space_is_table;
extern uint32_t off_fd_ofiles;
extern uint32_t off_fp_fglob;
extern uint32_t off_fg_data;
extern uint32_t off_pb_buffer;

uint64_t ksym(enum ksymbol sym);
void offsets_init(void);
