//
//  exploit.h
//  kmsg_bug
//
//  Created by Jake James on 3/2/22.
//

#ifndef exploit_h
#define exploit_h

#include <stdio.h>
#include <mach/vm_types.h>

void exploit(void);

struct vm_map_links {
    struct vm_map_entry     *prev;          /* previous entry */
    struct vm_map_entry     *next;          /* next entry */
    vm_map_offset_t         start;          /* start address */
    vm_map_offset_t         end;            /* end address */
};

struct vm_map_header {
    struct vm_map_links     links;          /* first, last, min, max */
    int                     nentries;       /* Number of entries */
    boolean_t               entries_pageable;
    int                     page_shift;     /* page shift */
};

struct vm_map_copy {
    int                     type;
#define VM_MAP_COPY_ENTRY_LIST          1
#define VM_MAP_COPY_OBJECT              2
#define VM_MAP_COPY_KERNEL_BUFFER       3
    vm_object_offset_t      offset;
    vm_map_size_t           size;
    union {
        struct vm_map_header hdr;    /* ENTRY_LIST */
        void                *object; /* OBJECT */
        void                *kdata;  /* KERNEL_BUFFER */
    } c_u;
};

#endif /* exploit_h */
